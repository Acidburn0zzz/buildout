Silva 3.0 test notes
====================

This is the done signal:
DONE - "Informations" should be "Information".

When something's done I'll test it and, assuming a positive result, delete it from this list.

++ Items with a plus need to be fixed to get infrae.com running in 3.0.


General comments
----------------

++ We have to support these URL schemes: tel, itms, webcal. Someday we'll need a service for this, especially as we do more mobile sites, but for now a text list will suffice.
  This goes back to https://issues.infrae.com/wuw/issue508
  Ref.: https://en.wikipedia.org/wiki/URI_scheme

- When in a tab and you want to reload it (just to be sure it's up to
  date) you go to the selected tab, hover, your cursor turns to a
  pointer so it's obviously a link, you click, and nothing
  happens. However sometimes, when in a subscreen like "View previous
  version", the link does work and it's the only way to get back to
  the main screen. Best would be if the link always worked. Second
  best is that the tab ceases to be a link when selected, but then you
  have to go to another tab and back to get a reload.

- Changing languages does not change the UI. The user must reload. Can
  we do that for the user?

- What is this? :)
  <link rel="shortcut icon"      href="http://next30.infrae.com/++static++/silvatheme.renaissance/:version:2011-10-31T20:22:09/('img', 'favicon.ico')" />

Login
=====
= It seems the login form now appears in the content area of the
  location where you're at, instead of displaying the layout at the
  root of the site. Did this change? It's much more friendly.

- Logout and in: after clicking the logout button the browser goes to:
  http://next30.infrae.com/service_members/logout If I want to login
  immediately (noticed a typo or as another user) it's not possible to
  login and you can try as many times as you like. This was really
  confusing and needs to change.

- I left my screen open overnight, and when I came back the next
  morning I tried to do something. That login form came up, the one
  you can't ever successfully login to. Damn frustrating. What is its
  purpose? Can we remove it?
  I hope so. It also displays a model dialog with "You are now authenticated."
  and the page won't load until you click "Continue". But I realize that this
  is temporary, it's just our users shouldn't use it.

Import screen
-------------

Export screen
-------------

Contents screen
---------------

DONE - Bug: when cutting both a doc and an image and pasting them in a container,
  after the paste only the doc is visible. It looks like I forgot to cut the
  image. However the image is there, the asset disclosure triangle is pointing
  down, but the image is not rendered.

- When a document is closed it's not possible to publish it. You must create
  a new version, and then publish it. Can we help the user and provide a
  shortcut so closed content can be published in one shot? Any feature that
  adds clicks is not an improvement.

- When a document is published, the "Go to" button has Preview. as the first
  option. It should have View too. Save a click.

Access screen
-------------

DONE - You can remove your own role, and then you're locked out. :-) This
  wasn't possible before.

- If you get locked out, you get a model password prompt in the SMI. I
  could not login with this. I had to reload, which took me back to
  the home page with the nested login form, and then I could
  login. This is real glitch that could frustrate a user.

Settings screen of folder
-------------------------

DONE - When changing a folder to a publication, after I click the convert
  button, I get feedback but nothing happens. The sidebar doesn't
  change and the icon in the header is still a folder icon. I have to
  reload to see the changes.

Editor screen
-------------
DONE (Click on it) - When I save a document often the next step is to preview. But, the feedback
  obscures the button. Then if I want to place my cursor over my next click
  target and I hover over the feedback, it never goes away! :) Let's move
  the feedback. Down 30 pixels so it doesn't obscure the Preview/View button.
  Or place it on the left.

Publish screen of docs, logged in as Author
-------------------------------------------

Publish screen of docs, logged in as ChiefEditor
------------------------------------------------

THERE UNITTEST AT LEAST FOR THAT + To test: Is the publishing workflow
  email working?

Functional fixes
~~~~~~~~~~~~~~~~

Datetime fields

Publication time

- Manually filling in 28-8-11 causes an error (on the 11). The server
  should interpret the 11 as 2011. Only happens for Editors, for
  Authors the year is correctly interpreted. Should be easy to
  fix. Then we can probably ignore the following:

- Wrong feedback after internal system error. To reproduce, go to a
  document and fill in a year of '11'. Click "Publish now". You'll
  get the "An internal error happened" alert. Click "Continue". Then
  click a folder in the sidebar. Feedback appears, saying "Version
  published".

Notes since changing the fields

- If I remove the year completely, the whole row goes pink and I get
  validation feedback "Missing year value.". However if I fill in
  '11', the only feedback is the pink glowing border, and I can still
  submit and get the error described above.

- Why can Authors successfully submit a year of '11' but not Editors?
  The '11' gets correctly interpreted in the Author's submit, but Editors
  get a system error. Can you make it interpret correctly for Editors
  too? Saves 2 chars.

Expiration time

Manage versions

- Please make the version status text a link to view it. Now we're
  adding a click, by making users first select a checkbox, then click
  "View". If you want to keep it black we'll style the link that way.

- Delete: When selecting items for deletion, the form remains sticky
  with selections after deletion, e.g. if you delete versions 2 and 3,
  the form comes back with items 0 and 1 selected.

- Delete: We don't ask, "Are you sure?" on the delete action. Should we?

- View: when viewing an old version the "Publish now" button in the
  header should not appear, as you're not publishing the version
  you're viewing. Change it to a "Return" button?

Properties screen
-----------------

- hide from tables of content

Subscriptions screen
--------------------

++Subscriptions don't seem to send mail


Image
=====

DONE = When an image is added it gets a yellow background which looks horrible.
  This goes against WYSIWYG (and looks like the old forms editor, gah). That
  yellow is only used to indicate something that does not show up in
  preview/public view. Please remove the yellow from the image backgrounds.
  I adjusted the yellow.

Image sidebar
-------------

DONE - Bug: In the the edit tab the "edit content" icon for docs in References
  is not found.

- If an image is cropped, the thumbnail has incorrect proportions in
  the html. If the image is 804x465 pixels scaled to 142x120 pixels,
  the img tag has attributes width="120" height="101". These
  proportions match the crop, but the thumbnail displays the original
  image, and should have the same proportions.

Link
====

target of relative link

- Change to "Click the Lookup button to select an item to refer to."
  (Writing "a content" is not good form, the word content is treated as
  a plural form. Not sure why....)

Autotoc
=======

- When previewing an Autotoc, content in draft mode doesn't appear.

Add forms
=========

- The generic id and title field are too short. The id can't hold more
  than:'new_directions_in_econi'. This is way too short for our
  clients. Those fields should have a size that matches the
  textareas. For now make them bigger, like size="40".

Ghost, Ghost Folder, Link

- Change "no reference selected" to "Click the Lookup button to select
  a reference. "



Metadata system
===============

+ It's not possible to make a metadata set editable. It 404s.

+ It's not possible to add a field to a metadata set. It 404s.


UI/usability fixes
~~~~~~~~~~~~~~~~~~

Submit buttons and reporting

- When a doc is approved for the future, you can't see that it is
  approved for the future. The only indication is the "Publish Now"
  button changes to "Revoke Approval". No information about the future
  date of publication is visible. You only see "Manage versions". It's
  especially confusing if a doc is already published, then you see
  "Manaal close" and a "x Close published version" button, but nothing
  about the approval:
  (http://next30.infrae.com/edit#publish!products/lxml). We can
  display the future approval date in the "Information", but I'd
  rather see it in the form body itself because that's where users
  will be looking.

Manual close

- Under "Manual close", the hint should have the same font-style as
  the field hints. The selector is '.form-head p'. Currently hints are
  in italic (which should change because it doesn't make sense, but
  let's first be consistent).

- Vertical space under "Manual close" between hint and button needs to
  collapse and match the spacing between hints and fields.

Manage versions

- Personally I miss the link colors for Unapproved, Published, and
  Last closed. They made it so clear and you could instantly see what
  was what. Now you have to read each one. We do have room to put
  colored balls next to the version number but they won't look good.

- View: when viewing an old version there's no obvious way to get back
  the publish screen. We can let people learn to click on the already
  selected tab, but that's not obvious.

(BROWSER->DUTCH) Date rendering and interpretation

Logged in as Author
===================

Publish screen of docs
----------------------

Publication time

I HAVE TO EXPLAIN THAT ONE - Strangely, if I enter '11' into the year
  field as an Author, the value is accepted and becomes 2011. This
  fails when an Editor publishes.

Message

- The text area (this and all the others) has a fixed width and is
  often too long. Granted, in Safari and recent FF you can scale it
  yourself. A max-width that is 20px less than its parent should work.
  THEY DIDN'T HAVE IN THE OLD ONE EITHER. PLEASE PROPOSE TITLES - The
  "Request appoval", "Withdraw approval request", "Reject approval
  request", and probably more button/links don't have a title
  attribute:
"Request approval": Submit this content to be published.
"Withdraw approval request": Re-edit this content.
"Reject approval request": Put this content back in draft mode.


Logged in as ChiefEditor
========================

Publish screen of docs
----------------------

- When an Editor goes to the Publish screen of a doc that's been
  submitted for approval, it's not really obvious that the doc is
  waiting for approval. The only indication is there's both a "Publish
  Now" and "Reject Request" button (looking good together). Not sure
  if we should do something more.


SNN
===
- Inside new News Pubs the addables are not set correctly.

- The month field lets me fill in '19'. Can the inline validation do a
  range check like it does in publish?

- After submitting the above entry, the entire multi-field goes pink,
  and I have no idea which of the seven fields contains the error. We
  need to figure out something here. Don't we know what the invalid
  entry is?

++ See the double title:
  http://next30.infrae.com/edit#content!news/silva_security_bulletin_04-10-11
  """WB: The title is not set in the content anymore so it can be removed from the
  content. De we need an updated to remove this titel automatically?"""

Silva News Filter

- Title field(s) are too short. Make them size="40".

- The "montrer les éléments d'agenda" checkbox with no label looks
  lost. Can we always put a 'Yes" label next to these?

SilvaFind
=========

+ The Zope level icons are being used in the search results. We should make the
  Zope icons match. This is something Wim or I can do if you explain it.

+ How do we call a stylesheet for a specific metatype now? I used to include it
  in the head inject but I think there's a cleaner way, e.g. I see calendar.css
  in SNN. We need one for Find objects.

- The rendering of Events is funky, seems to use get_intro but there's a year in
  there and the title has a nested strong tag. Search for EuroPython to see it.

External Sources
================
- When editing an External Source in the editor, the source edit form doesn't
  display the title of the source, so you have no idea which Code/SQP/CSV
  source you're editing. Please make the title display at the top of the form.

+ It's not possible to tab between fields in the External Source Settings form.
  Somehow we have to fix this usability problem.

++ When adding a Code Source there is now a built-in "Source alignment" field
  which is nice, saves adding it to every source. The rendering of the classes
  is problematic.
  For align-right it adds the class 'source-right'. For float right it adds
  "source-float-right". These must be the 'generic' selectors, as found in
  existing stylesheets, in order to be compatible with existing skins. These are
  the alignments in the CSS of various skins:
.default
.align-left
.align-right
.align-center
.float-left
.float-right

+ Bug: when an 'illegal' char is entered into certain Code Source fields, the
  source becomes un-editable, e.g. try entering 'ünâligned' into the css style
  field. This is new. The source/page saves, publishes, and renders just fine,
  but when you try to edit the source you get a js error:
  "An unexpected error happened on the server while retrieving Code source
  parameters. The Code Source might be buggy."
  http://preprod30.infrae.com/edit#content!lobby/testors/univalue
  http://infrae.com/lobby/testors/univalue/edit/tab_edit
  The only solution is to delete the whole source and make it again. But that's
  a pain and the Author may not know what went wrong in the first place. See the
  following bug....

+ Bug: this may be related to the preceding bug. Go to this document with FF:
  http://preprod30.infrae.com/edit#content!lobby/testors/quote
  Don't edit anything, just save. The values of the Code Source will be removed.
  Then if you doubleclick it you can edit it without a problem (even if there
  were curly quotes and other strange chars in the string fields). If, however,
  you got to this page and modify the Code Source, then is saves fine. Weird.
  Could the "Data encoding" metadata have something to do with it?

+ Bug: more weirdness. Maybe it has something to do with having two code sources
  in one document. On this page I created two codes sources to test the
  difference. I put the same content in both. Whichever one I edit last retains
  its values on save. The other one loses all its values:
  http://preprod30.infrae.com/edit#content!lobby/testors/relatedinfo
  I just recreated both and they're both retained on the first save. Try saving
  again and see what happens.

+ Bug: in Silva 3.0 existing Code Sources lose all their values if a parameter
  is deleted. This happens on save when the Code Source itself wasn't edited:
  http://preprod30.infrae.com/++preview++/about
  If you scroll down, next to the "Open Source Experience" heading there's an
  empty Code Source, which used to contain values as like here:
  http://infrae.com/about
  I deleted the alignment parameter, since it's now built-in, and when I tested
  I noticed that it lost all parameter values. Can this be fixed so existing
  values are preserved?

External Source rendering
-------------------------
+ This is the output of a Code Source:

<div class="external-source source-right">
<div><!-- PyPI Linker code source -->
<div class="info plot">
<h3>
<a href="http://pypi.python.org/pypi" title="Visit the Python Package Index">
<img alt="PyPI logo" src="++static++/silvatheme.renaissance/img/python.png" height="14" width="14"></a>
<acronym title="Python Package Index">PyPI</acronym>
</h3>
<p>
FCRepo is also available on the Python Package Index:
<br><a href="http://pypi.python.org/pypi/fcrepo" title="See FCRepo on the PyPI site">http://pypi.python.org/pypi/fcrepo</a>
</p>
</div>
<!-- /PyPI Linker code source --></div></div>

++ Line 2: there's an extra div with no class. Please remove it, we're 'over-divving' :) and this messes up the selector cascade.

- It would be nice if the last line had breaks before the divs. Can I tweak the 'to_html' code?

CS Silva Portlet
----------------
++ If the document you're embedding is in the root, the souce throws an error.
  Example doc: http://preprod30.infrae.com/edit#content!lobby/testors/portleteur
  Embedded doc: http://preprod30.infrae.com/edit#content!lobby/locateabove
  Code Source: http://preprod30.infrae.com/cs_portlet_element/editCodeSource


CKEditor
========
- The source view has light gray text and is hard to read. Make it dark gray.

++ When a document saves, there is always a break at the end. This may be an
  artifact from the old editor, but it should not be rendered. Messes up
  layouts. Another time I got an empty p, same problem.
  http://next30.infrae.com/edit#content!tweetfeeder
  If you're lucky you can css hack around the p: section#follow p {display:none}
  but there's no way to get rid of the <br>. The source contains:
  <br></article>

+ How do we call a document without its title? Looks like @@content.html gets
  the title and the body, but sometimes users call the title elsewhere, higher
  up in the layout template, and they only want the body. Seems like this is a
  problem with news items too. @@body.html ?

- The document title seems to have a one-way connection to the metadata title.
  If you edit the metadata title it doesn't show up in the document (yet it's
  used in the SMI listing). However if you edit the title in the document, that
  overwrites the metadata title.

++ We seem to have lost the preformatted text style. It can be added manually,
  but for compatibility we should put in a pre at the end of the list.


Logout
======

- When a user logs out, they are sent to service_members/logout. This
  triggers the login form to appear. Why? If you want to log in again,
  you can't. Can we just send them to the public view of where they
  were?

- When you logout from a certain location you can still visit that page in the
  smi which looks like your still logged in, only when you do a hard refresh
  (or other action like edit) you get the login screen. I suppose this has to
  do with caching and that it is not an issue.

Reference dialog
================

- Reference dialog title: s/"Lookup a content" / "Lookup an item"

- The reference dialog has a difficult user interface if there are more
  than a few items in the listing. The selection(s) show up at the bottom
  of the listing, often out of sight for the user. Can we put the selected
  list on top?
  """WB: Which reference dialog is this? The ones I use only use one reference
  selection, which is never displayed"""

- In the reference dialog clicking the icon of a non-container doesn't do
  anything. Make it trigger the same action as the 'plus' icon on the right.
  This obviates the need to move the mouse across the screen, which new
  users find confusing because the selection checkbox used to be on the left.
  """WB: Non of the icons reference the add action, only the '+' icon adds a
  reference."""

Bugs
====
- How can a user export one document? We only have an export screen in
  containers now. Can we add an Export option to the "Edit" tab, like the
  Details option in news items?

To Test
-------
- CSV upload has problems.
  Invalid CSV file: new-line character seen in unquoted field - do you need to open the file in universal-newline mode?

Zope
----
- The logo upload widget in /service_ui/manage_settings is buggy. Sylvain said he'll replace it with another.

+ I cannot cut and paste code sources. Tried to move cs_flash_source and cs_googlemaps down a level but I get a login prompt. I think this is recent.


Content Layout
==============

= Any feature that adds clicks is not an improvement.
