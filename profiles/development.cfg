[buildout]
extends = base.cfg
parts +=
   test
   test-all
   test-zeam
   dependencies
   silva-translation
extensions =
   buildout.dumppickedversions
   mr.developer
sources = sources
auto-checkout = *
always-checkout = true

[sources]

[silva-translation]
recipe = infrae.i18nextract
packages =
   Products.Silva
   Products.SilvaDocument
   Products.SilvaExternalSources
   silva.core.conf
   silva.core.layout
   silva.core.smi
   silva.core.views
   zeam.form.silva
domain = silva

[pyflakes]
recipe = zc.recipe.egg
index = https://dist.infrae.com/thirdparty/
find-links = https://dist.infrae.com/thirdparty/
scripts =
   pyflakes
eggs =
   pyflakes
   setuptools
entry-points = pyflakes=pkg_resources:run_script
arguments = 'pyflakes', 'pyflakes'

[python-zope]
recipe = zc.recipe.egg
eggs =
   ${instance:eggs}
interpreter = pyzope
scripts =
   pyzope
   eggdeps

[silva-all]
recipe = collective.recipe.omelette
eggs = ${instance:eggs}

[test]
recipe = zc.recipe.testrunner
eggs =
  Products.Silva [test]
  Products.SilvaDocument
  Products.SilvaExternalSources
  Products.SilvaFind
  Products.SilvaForum
  Products.SilvaMetadata
  Products.SilvaNews
  Sprout [test]
  infrae.layout [test]
  infrae.rest [test]
  infrae.wsgi [test]
  silva.app.redirectlink [test]
  silva.core.conf
  silva.core.layout [test]
  silva.core.messages
  silva.core.references [test]
  silva.core.services
  silva.core.smi [test]
  silva.core.upgrade
  silva.core.views [test]
  silva.export.opendocument
  silva.resourceinclude [test]
  silva.searchandreplace
  silva.security.logging
  silva.security.overview
  zeam.utils.batch

defaults = ['--tests-pattern', '^f?tests$', '-v']

[test-zeam]
recipe = zc.recipe.testrunner
eggs =
  zeam.form.base [test]
  zeam.form.ztk [test]
  zeam.form.composed [test]
  zeam.form.viewlet
defaults = ['--tests-pattern', '^f?tests$', '-v']

[test-all]
recipe = zc.recipe.testrunner
eggs = ${test:eggs}
defaults = ['-m', 'Products.Silva', '-m', 'silva', '-m', 'infrae', '-m', 'sprout', '--tests-pattern', '^f?tests$', '-v']

[dependencies]
recipe = z3c.recipe.depgraph
eggs = ${instance:eggs}

